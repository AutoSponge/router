!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Router=t()}}(function(){var t,e,n;return function r(t,e,n){function i(s,o){if(!e[s]){if(!t[s]){var a="function"==typeof require&&require;if(!o&&a)return a(s,!0);if(u)return u(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=e[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,r,t,e,n)}return e[s].exports}for(var u="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,n){"use strict";function r(t,e){this.path=t,this.fn=e,this.segments=t.split("/"),this.params=[],this.eventPath=this.getEventPath()}var i=t("./RouteParam");r.prototype={getEventPath:function(){return this.segments.map(this.formatSegment()).join("/")},formatSegment:function(){var t=this;return function(e,n){return":"===e.charAt(0)?(t.params.push(new i(e.substring(1),n)),"_"):"*"===e?"*":e}}},e.exports=r},{"./RouteParam":2}],2:[function(t,e,n){"use strict";function r(t,e){this.position=e,this.name=t}e.exports=r},{}],3:[function(t,e,n){"use strict";function RouterEvent(t,e){this.path=t,this.currentPath=t,this.current=this.splitPath(),this.segments=this.splitPath(),this.data=this.getData(e)}RouterEvent.prototype={splitPath:function(){return this.path.split("/")},getData:function(t){return Array.call.apply(Array,t)},updatePath:function(){return this.currentPath=this.current.join("/"),this.currentPath}},e.exports=RouterEvent},{}],4:[function(t,e,n){"use strict";function RouterResponse(t,e){this.event=t,this.params=this.getParams(e),this.splat=this.getSplat(),this.route=e.path,this.fn=e.fn}RouterResponse.prototype={getParams:function(t){return t.params.reduce(this.assignParam(),{})},getSplat:function(){var t=this.event.current.length-1;return"*"===this.event.current[t]?this.event.segments.slice(t).join("/"):""},assignParam:function(){var t=this;return function(e,n){return e[n.name]=t.event.segments[n.position],e}}},e.exports=RouterResponse},{}],5:[function(t,e,n){"use strict";function r(t,e){return e[1]&&"_"!==e[1]&&"*"!==e[1]&&t.current.splice(-1,1,"_")}function i(t){for(;t.segments.length>t.current.length;)t.current.push("_");return!0}function u(t,e){return"_"!==e[0]&&"*"===e[1]&&t.current.splice(-2,2,"_","_")&&i(t)}function s(t,e){return"_"===e[1]&&t.current.splice(-1,1,"*")}function o(t,e){return"_"===e[0]&&"*"===e[1]&&t.current.splice(-2,2,"*")}function a(t,e){return function(n){return n(t,e)}}function Router(){var t={};this.addRoute=function(e,n,r){var i=new c(e,n);t[i.eventPath]=r?i:t[i.eventPath]||i},this.removeRoute=function(e){var n=new c(e,null);delete t[n.eventPath]},this.handleEvent=function(e){var n;return n=t[e.updatePath()],n&&new RouterResponse(e,n)}}var c=t("./Route"),RouterResponse=t("./RouterResponse"),RouterEvent=t("./RouterEvent");Router.create=function(){return new Router},Router.prototype={match:function(t){var e=t.split?new RouterEvent(t,arguments):t;return this.handleEvent(e)||this.reduceSpecificity(e)},reduceSpecificity:function(t){return[r,u,s,o].some(a(t,t.current.slice(-2)))&&this.match(t)},addHandler:function(t,e){var n=this;return function(r){return n.addRoute(r,t,e)}}},Router.instance=new Router,e.exports=Router},{"./Route":1,"./RouterEvent":3,"./RouterResponse":4}]},{},[5])(5)});